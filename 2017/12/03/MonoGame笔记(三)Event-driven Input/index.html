<!DOCTYPE html>



  


<html class="theme-next mist use-motion" lang="zh-CN">
<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css">







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css">

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="编程,">










<meta name="description" content="XNA中Input的检测是放在Update方法中的, 也就是说每一帧都在轮询输入设备123456789KeyboardState keyboardState = Keyboard.GetState( );if (keyboardState.IsKeyDown(Keys.Left))ringsPosition.X -= ringsSpeed;if (keyboardState.IsKeyDown(K">
<meta name="keywords" content="编程">
<meta property="og:type" content="article">
<meta property="og:title" content="MonoGame笔记(三)Event-driven Input">
<meta property="og:url" content="http://yoursite.com/2017/12/03/MonoGame笔记(三)Event-driven Input/index.html">
<meta property="og:site_name" content="远">
<meta property="og:description" content="XNA中Input的检测是放在Update方法中的, 也就是说每一帧都在轮询输入设备123456789KeyboardState keyboardState = Keyboard.GetState( );if (keyboardState.IsKeyDown(Keys.Left))ringsPosition.X -= ringsSpeed;if (keyboardState.IsKeyDown(K">
<meta property="og:locale" content="zh-CN">
<meta property="og:updated_time" content="2017-12-03T08:37:55.940Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="MonoGame笔记(三)Event-driven Input">
<meta name="twitter:description" content="XNA中Input的检测是放在Update方法中的, 也就是说每一帧都在轮询输入设备123456789KeyboardState keyboardState = Keyboard.GetState( );if (keyboardState.IsKeyDown(Keys.Left))ringsPosition.X -= ringsSpeed;if (keyboardState.IsKeyDown(K">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Mist',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: 'Author'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/2017/12/03/MonoGame笔记(三)Event-driven Input/">





  <title>MonoGame笔记(三)Event-driven Input | 远</title>
  








</head>

<body itemscope="" itemtype="http://schema.org/WebPage" lang="zh-CN">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope="" itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">远</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br>
            
            Home
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br>
            
            About
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br>
            
            Tags
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br>
            
            Categories
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br>
            
            Archives
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/12/03/MonoGame笔记(三)Event-driven Input/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="zmapleaf">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="远">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">MonoGame笔记(三)Event-driven Input</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-12-03T15:59:37+08:00">
                2017-12-03
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing">
                  <a href="/categories/编程/" itemprop="url" rel="index">
                    <span itemprop="name">编程</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <p>XNA中Input的检测是放在Update方法中的, 也就是说每一帧都在轮询输入设备<br><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">KeyboardState keyboardState = Keyboard.GetState( );</span><br><span class="line"><span class="keyword">if</span> (keyboardState.IsKeyDown(Keys.Left))</span><br><span class="line">ringsPosition.X -= ringsSpeed;</span><br><span class="line"><span class="keyword">if</span> (keyboardState.IsKeyDown(Keys.Right))</span><br><span class="line">ringsPosition.X += ringsSpeed;</span><br><span class="line"><span class="keyword">if</span> (keyboardState.IsKeyDown(Keys.Up))</span><br><span class="line">ringsPosition.Y -= ringsSpeed;</span><br><span class="line"><span class="keyword">if</span> (keyboardState.IsKeyDown(Keys.Down))</span><br><span class="line">ringsPosition.Y += ringsSpeed;</span><br></pre></td></tr></table></figure></p>
<p>这种方式跟Flash或者U3D的使用经验不同, 也和WPF/Winform的开发方式不同.<br>后者的使用方式类似btn.OnClick += ClickHanlder/btn.addClickListener(ClickHandler)/<br>btn.addListener(Mouse.Click, ClickHandler)</p>
<p>GitHub上有一个MonoGame-EventDriven-Input项目<br><a href="https://github.com/ClassicThunder/MonoGame-EventDriven-Input" target="_blank" rel="noopener">https://github.com/ClassicThunder/MonoGame-EventDriven-Input</a></p>
<p>作者提到轮询方式的缺点:</p>
<blockquote>
<p>XNA has a rather severe limitation with regards to handling keyboard input. It is unable detect any keystrokes that occur between pollings. Because of this if your game is updating at the default 60 fps there are 0.017 seconds between polls can be too slow for individual characters of memorized sequences such as “ing”. This method also has the advantage of behaving consistently with other applications, the double click time, character repeat time, etc… are all controlled by your windows settings.</p>
</blockquote>
<blockquote>
<p>两帧之间的Input检测不到</p>
</blockquote>
<p>那它是如何做到Event-driven的? 以下是使用方式<br><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">Input _eventDrivenInput;</span><br><span class="line">_eventDrivenInput = <span class="keyword">new</span> MonoGameInput(<span class="keyword">this</span>);</span><br><span class="line"></span><br><span class="line">_eventDrivenInput.Update(gameTime);</span><br><span class="line"></span><br><span class="line">_eventDrivenInput.KeyDown += (sender, keyDown) =&gt;</span><br><span class="line">&#123;</span><br><span class="line">  <span class="comment">//Subscribe to the events </span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></p>
<blockquote>
<p>Using the library is very simple. Simple create an instance of the MonoGameInput object, call Update in the Game.Update function, and then subscribe to the events.</p>
</blockquote>
<blockquote>
<p>在Game.Update中调用_eventDrivenInput.Update(gameTime);</p>
</blockquote>
<p>看MonoGameInput的Update<br><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">sealed</span> <span class="keyword">class</span> <span class="title">MonoGameInput</span> : <span class="title">Input</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">readonly</span> MonoGameMouseEvents _mouseEvents;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">readonly</span> MonoGameKeyboardEvents _monoGameKeyboardEvents;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">readonly</span> MonoGameTouchEvents _monoGameTouchEvents;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">override</span> <span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Update</span>(<span class="params">GameTime gameTime</span>) </span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        _mouseEvents.Update(gameTime);</span><br><span class="line">        _monoGameKeyboardEvents.Update(gameTime);</span><br><span class="line">        _monoGameTouchEvents.Update(gameTime);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>再看MonoGameMouseEvents的Update</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">internal</span> <span class="keyword">class</span> <span class="title">MonoGameMouseEvents</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">internal</span> <span class="keyword">event</span> EventHandler&lt;MouseEventArgs&gt; ButtonReleased;</span><br><span class="line">    <span class="keyword">internal</span> <span class="keyword">event</span> EventHandler&lt;MouseEventArgs&gt; ButtonPressed;</span><br><span class="line">    <span class="keyword">internal</span> <span class="keyword">event</span> EventHandler&lt;MouseEventArgs&gt; ButtonDoubleClicked;</span><br><span class="line">    <span class="keyword">internal</span> <span class="keyword">event</span> EventHandler&lt;MouseEventArgs&gt; MouseMoved;</span><br><span class="line">    <span class="keyword">internal</span> <span class="keyword">event</span> EventHandler&lt;MouseEventArgs&gt; MouseWheelMoved;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> MouseState _previous;</span><br><span class="line">    <span class="keyword">private</span> MonoGameMouseEventArgs _lastClick;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">internal</span> <span class="keyword">void</span> <span class="title">Update</span>(<span class="params">GameTime gameTime</span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        <span class="keyword">var</span> current = Mouse.GetState();</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// Check button press events.</span></span><br><span class="line">        <span class="keyword">if</span> (current.LeftButton == ButtonState.Pressed </span><br><span class="line">            &amp;&amp; _previous.LeftButton == ButtonState.Released) </span><br><span class="line">        &#123;</span><br><span class="line">            OnButtonPressed(<span class="keyword">this</span>, <span class="keyword">new</span> MonoGameMouseEventArgs(</span><br><span class="line">                current.X,</span><br><span class="line">                current.Y, </span><br><span class="line">                gameTime.TotalGameTime,</span><br><span class="line">                _previous, </span><br><span class="line">                current,</span><br><span class="line">                MouseButton.Left));</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (current.MiddleButton == ButtonState.Pressed </span><br><span class="line">            &amp;&amp; _previous.MiddleButton == ButtonState.Released) </span><br><span class="line">        &#123;</span><br><span class="line">            OnButtonPressed(<span class="keyword">this</span>, <span class="keyword">new</span> MonoGameMouseEventArgs(</span><br><span class="line">                current.X,</span><br><span class="line">                current.Y, </span><br><span class="line">                gameTime.TotalGameTime,</span><br><span class="line">                _previous,</span><br><span class="line">                current,</span><br><span class="line">                MouseButton.Middle));</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (current.RightButton == ButtonState.Pressed </span><br><span class="line">            &amp;&amp; _previous.RightButton == ButtonState.Released) </span><br><span class="line">        &#123;</span><br><span class="line">            OnButtonPressed(<span class="keyword">this</span>, <span class="keyword">new</span> MonoGameMouseEventArgs(</span><br><span class="line">                current.X, </span><br><span class="line">                current.Y, </span><br><span class="line">                gameTime.TotalGameTime,</span><br><span class="line">                _previous,</span><br><span class="line">                current, </span><br><span class="line">                MouseButton.Right));</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (current.XButton1 == ButtonState.Pressed</span><br><span class="line">            &amp;&amp; _previous.XButton1 == ButtonState.Released) </span><br><span class="line">        &#123;</span><br><span class="line">            OnButtonPressed(<span class="keyword">this</span>, <span class="keyword">new</span> MonoGameMouseEventArgs(</span><br><span class="line">                current.X,</span><br><span class="line">                current.Y,</span><br><span class="line">                gameTime.TotalGameTime,</span><br><span class="line">                _previous, </span><br><span class="line">                current,</span><br><span class="line">                MouseButton.XButton1));</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (current.XButton2 == ButtonState.Pressed</span><br><span class="line">            &amp;&amp; _previous.XButton2 == ButtonState.Released) </span><br><span class="line">        &#123;</span><br><span class="line">            OnButtonPressed(<span class="keyword">this</span>, <span class="keyword">new</span> MonoGameMouseEventArgs(</span><br><span class="line">                current.X,</span><br><span class="line">                current.Y, </span><br><span class="line">                gameTime.TotalGameTime,</span><br><span class="line">                _previous,</span><br><span class="line">                current,</span><br><span class="line">                MouseButton.XButton2));</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Check button releases.</span></span><br><span class="line">        <span class="keyword">if</span> (current.LeftButton == ButtonState.Released </span><br><span class="line">            &amp;&amp; _previous.LeftButton == ButtonState.Pressed) </span><br><span class="line">        &#123;</span><br><span class="line">            OnButtonReleased(<span class="keyword">this</span>, <span class="keyword">new</span> MonoGameMouseEventArgs(</span><br><span class="line">                current.X,</span><br><span class="line">                current.Y, </span><br><span class="line">                gameTime.TotalGameTime,</span><br><span class="line">                _previous,</span><br><span class="line">                current, </span><br><span class="line">                MouseButton.Left));</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (current.MiddleButton == ButtonState.Released</span><br><span class="line">            &amp;&amp; _previous.MiddleButton == ButtonState.Pressed) </span><br><span class="line">        &#123;</span><br><span class="line">            OnButtonReleased(<span class="keyword">this</span>, <span class="keyword">new</span> MonoGameMouseEventArgs(</span><br><span class="line">                current.X, </span><br><span class="line">                current.Y, </span><br><span class="line">                gameTime.TotalGameTime,</span><br><span class="line">                _previous,</span><br><span class="line">                current,</span><br><span class="line">                MouseButton.Middle));</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (current.RightButton == ButtonState.Released</span><br><span class="line">            &amp;&amp; _previous.RightButton == ButtonState.Pressed) </span><br><span class="line">        &#123;</span><br><span class="line">            OnButtonReleased(<span class="keyword">this</span>, <span class="keyword">new</span> MonoGameMouseEventArgs(</span><br><span class="line">                current.X, </span><br><span class="line">                current.Y, </span><br><span class="line">                gameTime.TotalGameTime, </span><br><span class="line">                _previous, </span><br><span class="line">                current, </span><br><span class="line">                MouseButton.Right));</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (current.XButton1 == ButtonState.Released</span><br><span class="line">            &amp;&amp; _previous.XButton1 == ButtonState.Pressed) </span><br><span class="line">        &#123;</span><br><span class="line">            OnButtonReleased(<span class="keyword">this</span>, <span class="keyword">new</span> MonoGameMouseEventArgs(</span><br><span class="line">                current.X, </span><br><span class="line">                current.Y, </span><br><span class="line">                gameTime.TotalGameTime, </span><br><span class="line">                _previous, </span><br><span class="line">                current, </span><br><span class="line">                MouseButton.XButton1));</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (current.XButton2 == ButtonState.Released</span><br><span class="line">            &amp;&amp; _previous.XButton2 == ButtonState.Pressed) </span><br><span class="line">        &#123;</span><br><span class="line">            OnButtonReleased(<span class="keyword">this</span>, <span class="keyword">new</span> MonoGameMouseEventArgs(</span><br><span class="line">                current.X, </span><br><span class="line">                current.Y, </span><br><span class="line">                gameTime.TotalGameTime, </span><br><span class="line">                _previous, </span><br><span class="line">                current, </span><br><span class="line">                MouseButton.XButton2));</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Check for any sort of mouse movement. If a button is down, it's a drag,</span></span><br><span class="line">        <span class="comment">// otherwise it's a move.</span></span><br><span class="line">        <span class="keyword">if</span> (_previous.X != current.X || _previous.Y != current.Y)</span><br><span class="line">        &#123;</span><br><span class="line">            OnMouseMoved(<span class="keyword">this</span>, <span class="keyword">new</span> MonoGameMouseEventArgs(</span><br><span class="line">                current.X, </span><br><span class="line">                current.Y, </span><br><span class="line">                gameTime.TotalGameTime, </span><br><span class="line">                _previous, </span><br><span class="line">                current));</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Handle mouse wheel events.</span></span><br><span class="line">        <span class="keyword">if</span> (_previous.ScrollWheelValue != current.ScrollWheelValue)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">var</span> <span class="keyword">value</span> = current.ScrollWheelValue / <span class="number">120</span>;</span><br><span class="line">            <span class="keyword">var</span> delta = (current.ScrollWheelValue - _previous.ScrollWheelValue) / <span class="number">120</span>;</span><br><span class="line">            OnMouseWheelMoved(<span class="keyword">this</span>, <span class="keyword">new</span> MonoGameMouseEventArgs(</span><br><span class="line">                current.X, </span><br><span class="line">                current.Y, </span><br><span class="line">                gameTime.TotalGameTime, </span><br><span class="line">                _previous, </span><br><span class="line">                current, </span><br><span class="line">                MouseButton.None, </span><br><span class="line">                <span class="keyword">value</span>, </span><br><span class="line">                delta));</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        _previous = current;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<p>这里仍旧是在Update中遍历Mouse的状态, 依旧是轮询的方式. 只是在使用方式了采取了一种类似<strong>event-driven</strong>的写法, 不是真正的event-driven吧, 不知道是不是我的理解错了.</p>
<p>那为什么在XNA中是轮询(Polling), 而不是事件驱动(Event Driven)?  其他引擎呢? 像Flash默认是事件监听来响应输入的. 后面的笔记会试图回答这些问题.</p>

      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/编程/" rel="tag"># 编程</a>
          
        </div>
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2017/12/02/MedicalImaging笔记(X1) FoDicom传输(三)ThreadPoolQueue/" rel="next" title="MedicalImaging笔记(X1) FoDicom传输(三)ThreadPoolQueue介绍">
                <i class="fa fa-chevron-left"></i> MedicalImaging笔记(X1) FoDicom传输(三)ThreadPoolQueue介绍
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2017/12/03/MonoGame笔记(四)XNA Simple GUI/" rel="prev" title="MonoGame笔记(四)XNA Simple GUI">
                MonoGame笔记(四)XNA Simple GUI <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope="" itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">zmapleaf</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">66</span>
                  <span class="site-state-item-name">posts</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">2</span>
                  <span class="site-state-item-name">categories</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">11</span>
                  <span class="site-state-item-name">tags</span>
                </a>
              </div>
            

          </nav>

          

          

          
          

          
          

          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2018</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">zmapleaf</span>

  
</div>


  <div class="powered-by">Powered by <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a></div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">Theme &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Mist</a> v5.1.4</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  

  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.4"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.4"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  





  

  

  

  
  

  

  

  

</body>
</html>
